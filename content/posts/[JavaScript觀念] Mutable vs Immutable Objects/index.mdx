---
title: "[JavaScriptè§€å¿µ] Mutable vs Immutable Objects"
date: 2020-11-21
description: "ä»‹ç´¹JavaScriptä¸­å¾ˆé‡è¦çš„è§€å¿µ - **Mutable åŠ Immutable Objects**ï¼Œä¸¦ä»¥ç¯„ä¾‹è§£é‡‹ä»–å€‘çš„å·®åˆ¥ã€‚"
tags:
  - JavaScript
---

## å‰è¨€
ä»‹ç´¹JavaScriptä¸­å¾ˆé‡è¦çš„è§€å¿µ **Mutable åŠ Immutable Objects**ï¼Œä¸¦ä»¥ç¯„ä¾‹è§£é‡‹ä»–å€‘çš„å·®åˆ¥ã€‚

## Immutable object

- æ‰€æœ‰çš„[åŸå§‹è³‡æ–™å‹æ…‹(primitive)](https://developer.mozilla.org/en-US/docs/Glossary/Primitive)ï¼ŒåŒ…å« null, undefined, string, number, boolean, symbol, bigintï¼Œéƒ½æ˜¯immutableã€‚
- immutable objectæ˜¯é€écall by valueçš„æ–¹å¼ï¼ŒæœƒæŒ‡å‘æ–°åˆ†é…çš„è¨˜æ†¶é«”ä½ç½®å†å­˜å…¥å€¼ï¼Œå› æ­¤objectåœ¨å»ºç«‹ä¹‹å¾Œå°±ä¸å¯å†è¢«æ”¹è®Šã€‚
- ç•¶é‡æ–°è³¦å€¼æ™‚ï¼ŒæœƒæŒ‡å‘æ–°åˆ†é…çš„è¨˜æ†¶é«”ä½ç½®ï¼Œè€Œéç›´æ¥æ”¹è®Šè¨˜æ†¶é«”è£¡çš„å€¼ï¼ŒåŸæœ¬çš„è¨˜æ†¶é«”ä½ç½®æœƒè¢«garbage collectionï¼Œæ›å¥è©±èªªä»–æ˜¯è¢«å–ä»£è€Œä¸æ˜¯ç›´æ¥è¢«ä¿®æ”¹ã€‚

ğŸŒ° #1
```js
let a = 1; // å»ºç«‹ä¸€å€‹immutable object a
let b = a; // å‰µå»ºä¸€å€‹æ–°çš„è¨˜æ†¶é«”ä½ç½®ï¼Œcall by value açš„å€¼å­˜å…¥1ï¼ŒbæŒ‡å‘é€™å€‹æ–°çš„ä½ç½®
b = a + 1; // å‰µå»ºä¸€å€‹æ–°çš„è¨˜æ†¶é«”ä½ç½®ï¼Œcall by value açš„å€¼å­˜å…¥1+1=2ï¼ŒbæŒ‡å‘é€™å€‹æ–°çš„ä½ç½®ï¼Œå› æ­¤aä¸æœƒè¢«+1
console.log(a, b); // 1 2 -> å› ç‚ºæ˜¯ä¸åŒçš„è¨˜æ†¶é«”ä½ç½®ï¼Œæ”¹è®Šbä¹Ÿä¸æœƒå½±éŸ¿åˆ°a
a = 3; // aæŒ‡å‘æ–°åˆ†é…çš„è¨˜æ†¶é«”ä½ç½®è£¡é¢å­˜æ”¾3ï¼ŒåŸå…ˆå­˜æ”¾1çš„è¨˜æ†¶é«”ä½ç½®å‰‡æœƒè¢«åƒåœ¾å›æ”¶
```

ğŸŒ° #2
```js
function swap(a, b) {
  let temp = a;
  a = b;
  b = temp;
}

let x = 10;
let y = 20;
swap(x, y);
console.log(x, y) // 10 20 -> a bæ˜¯call by valueï¼Œå› æ­¤äº¤æ›ä¸¦ä¸æœƒå½±éŸ¿åˆ°å‚³å…¥çš„x y
```

## Mutable object

- é™¤äº†primitiveä¹‹å¤–çš„object, arrayéƒ½æ˜¯mutableã€‚
- mutable objectæ˜¯é€écall by sharingçš„æ–¹å¼ï¼Œå…±äº«åŒä¸€å€‹è¨˜æ†¶é«”ä½ç½®ï¼Œå› æ­¤objectå»ºç«‹ä¹‹å¾Œå¯å†è¢«æ”¹è®Šã€‚
- éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç•¶é‡æ–°è³¦å€¼æ™‚ï¼Œä»æœƒæŒ‡å‘æ–°åˆ†é…çš„è¨˜æ†¶é«”ä½ç½®ï¼ŒçµæŸåŸæœ¬çš„è¨˜æ†¶é«”å…±äº«ï¼Œå› æ­¤åŸæœ¬çš„objectä¸æœƒè¢«æ”¹è®Šã€‚

ğŸŒ° #1
```js
let a = {number: 0}; // å»ºç«‹ä¸€å€‹mutable object a
let b = a; // call by sharingï¼Œbèˆ‡aå…±äº«è¨˜æ†¶é«”ä½ç½®
b.number++;
console.log(b); // {number: 1}
console.log(a); // {number: 1} -> æ”¹è®Šbçš„åŒæ™‚aä¹Ÿè¢«æ”¹è®Šäº†
b = {age: 27}; // å°bé‡æ–°è³¦å€¼ï¼ŒbæŒ‡å‘æ–°çš„è¨˜æ†¶é«”ä½ç½®ï¼ŒçµæŸèˆ‡aå…±äº«è¨˜æ†¶é«”ä½ç½®
console.log(a); // {number: 1} -> aä¸æœƒè¢«æ”¹è®Š
```

ğŸŒ° #2
```js
function add(obj) {
  obj.number++;
}

let o = {number: 10};
add(o);
console.log(o.number); // 11 -> oèˆ‡objå…±äº«è¨˜æ†¶é«”ä½ç½®ï¼Œå› æ­¤æ”¹è®Šobjçš„åƒæ•¸ä¹ŸåŒæ™‚æœƒæ”¹è®Šoçš„åƒæ•¸

function add(obj) {
  obj = {
    number: obj.number + 1
  }; // å°objé‡æ–°è³¦å€¼ï¼ŒobjæŒ‡å‘æ–°çš„è¨˜æ†¶é«”ä½ç½®ï¼ŒçµæŸèˆ‡oå…±äº«è¨˜æ†¶é«”ä½ç½®
}

let o = {number: 10};
add(o)
console.log(o.number); // 10 -> oç¶­æŒä¸€æ¨£çš„å€¼
```

Reference:  
[https://developer.mozilla.org/en-US/docs/Glossary/Mutable](https://developer.mozilla.org/en-US/docs/Glossary/Mutable)
[https://blog.techbridge.cc/2018/06/23/javascript-call-by-value-or-reference/](https://blog.techbridge.cc/2018/06/23/javascript-call-by-value-or-reference/)